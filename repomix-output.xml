<repomix>
<header>
<instruction>
THE USER WANTS TO: There is a bug in the login retry logic. Which files do I need to fix it?

Attached is the SKELETON of the codebase.
Your job is to analyze this structure and identify which files are crucial to implement the request.
You are a Context Engineer. Your goal is to construct the CLI command for the next phase (Phase 2) that carefully isolates the relevant code while excluding noise.

## Tool Reference: rustymix
rustymix packs a codebase into a single context file.
- `--focus "pattern1,pattern2"`: Critical files/directories to read in FULL TEXT. Supports globs (e.g., `src/core/**`).
- `--ignore "pattern1,pattern2"`: Files/directories to completely EXCLUDE from the pack (e.g., `tests/**`, `legacy_crate/**`).

## Strategy
- Use globs (`**`) to select entire relevant directories.
- Exclude unrelated crates or directories to save tokens.
- Focus on interfaces and definitions first if the task is exploratory.

## Task
Based on the user's intent and the attached skeleton, return a SINGLE LINE containing the optimized `rustymix` command arguments.
Example: `--focus "src/auth/**,src/main.rs" --ignore "tests/**"`
DO NOT provide explanations. Just the arguments.
</instruction>
</header>
<summary>
  This file is a merged representation of the codebase.
</summary>
<directory_structure>
  src/config.rs
  src/language.rs
  src/security.rs
  src/output.rs
  src/git.rs
  src/fs_tools.rs
  src/cli.rs
  README.md
  Cargo.lock
  Cargo.toml
  src/main.rs
</directory_structure>
<files>
<file path="src/config.rs" mode="skeleton">
pub struct RepomixConfig {
    pub output: OutputConfig,
    pub ignore: IgnoreConfig,
    pub security: SecurityConfig,
}
// ... [implementation details hidden] ...
pub struct OutputConfig {
    pub file_path: String,
    pub style: OutputStyle,
    pub top_files_length: usize,
    pub show_line_numbers: bool,
    pub remove_comments: bool,
    pub remove_empty_lines: bool,
    pub compress: bool,
    pub copy_to_clipboard: bool,
    pub header_text: Option&lt;String&gt;,
    pub instruction_file_path: Option&lt;String&gt;,
    pub include_empty_directories: bool,
    pub include_diffs: bool,
    pub include_logs: bool,
}
// ... [implementation details hidden] ...
pub struct IgnoreConfig {
    pub use_gitignore: bool,
    pub use_default_patterns: bool,
    pub custom_patterns: Vec&lt;String&gt;,
}
// ... [implementation details hidden] ...
pub struct SecurityConfig {
    pub enable_security_check: bool,
}
// ... [implementation details hidden] ...
impl Default for OutputConfig {
    fn default() -&gt; Self {
        Self {
            file_path: "repomix-output.xml".to_string(),
            style: OutputStyle::Xml,
            top_files_length: 5,
            show_line_numbers: false,
            remove_comments: false,
            remove_empty_lines: false,
            compress: false,
            copy_to_clipboard: false,
            header_text: None,
            instruction_file_path: None,
            include_empty_directories: false,
            include_diffs: false,
            include_logs: false,
        }
    }
}
// ... [implementation details hidden] ...
impl Default for IgnoreConfig {
    fn default() -&gt; Self {
        Self {
            use_gitignore: true,
            use_default_patterns: true,
            custom_patterns: vec![],
        }
    }
}
// ... [implementation details hidden] ...
impl Default for SecurityConfig {
    fn default() -&gt; Self {
        Self {
            enable_security_check: true,
        }
    }
}
</file>
<file path="src/language.rs" mode="skeleton">
pub mod comments {
    use super::*;

    pub fn remove_comments(content: &amp;str, extension: &amp;str) -&gt; Option&lt;String&gt; {
        let pattern = match extension {
            "rs" | "ts" | "tsx" | "js" | "jsx" | "go" | "java" | "c" | "cpp" | "h" | "hpp" =&gt; {
                // C-style comments: // ... and /* ... */
                r"(?s)//.*?\n|/\*.*?\*/"
            },
            "py" | "sh" | "yaml" | "yml" | "toml" | "rb" | "pl" =&gt; {
                // Hash-style comments: # ...
                r"#.*"
            },
            _ =&gt; return None,
        };

        if let Ok(re) = Regex::new(pattern) {
             Some(re.replace_all(content, "").to_string())
        } else {
             None
        }
    }
}
// ... [implementation details hidden] ...
pub mod compression {
    use super::*;

    pub fn compress_content(content: &amp;str, extension: &amp;str) -&gt; Option&lt;String&gt; {
        let mut parser = Parser::new();

        let (language, query_str) = match extension {
            "rs" =&gt; (tree_sitter_rust::LANGUAGE.into(), RUST_QUERY),
            "ts" | "tsx" =&gt; (tree_sitter_typescript::LANGUAGE_TSX.into(), TS_QUERY),
            "js" | "jsx" =&gt; (tree_sitter_javascript::LANGUAGE.into(), JS_QUERY),
            "py" =&gt; (tree_sitter_python::LANGUAGE.into(), PYTHON_QUERY),
            "go" =&gt; (tree_sitter_go::LANGUAGE.into(), GO_QUERY),
            _ =&gt; return None, // Language not supported for compression
        };

        parser.set_language(&amp;language).ok()?;
        let tree = parser.parse(content, None)?;
        let query = Query::new(&amp;language, query_str).ok()?;
        let mut cursor = QueryCursor::new();

        // We collect ranges of "essential" code (signatures, headers)
        let mut ranges = Vec::new();

        let mut matches = cursor.matches(&amp;query, tree.root_node(), content.as_bytes());
        while let Some(m) = matches.next() {
            for capture in m.captures {
                let node = capture.node;
                ranges.push(node.byte_range());
            }
        }

        if ranges.is_empty() {
            return Some(content.to_string()); // Fallback if no definitions found
        }

        // Sort and merge overlapping ranges
        ranges.sort_by(|a, b| a.start.cmp(&amp;b.start));

        let mut merged_ranges = Vec::new();
        let mut current_range = ranges[0].clone();

        for next in ranges.into_iter().skip(1) {
            if next.start &lt;= current_range.end {
                current_range.end = std::cmp::max(current_range.end, next.end);
            } else {
                merged_ranges.push(current_range);
                current_range = next;
            }
        }
        merged_ranges.push(current_range);

        // Reconstruct content
        let mut result = String::new();
        let bytes = content.as_bytes();
        let separator = "\n// ... [implementation details hidden] ...\n";

        for range in merged_ranges {
            let chunk = String::from_utf8_lossy(&amp;bytes[range.start..range.end]);
            if !result.is_empty() {
                result.push_str(separator);
            }
            result.push_str(chunk.trim());
        }

        Some(result)
    }

    // Simplified queries to capture definitions/signatures
    const RUST_QUERY: &amp;str = r#"
        (function_item) @f
        (impl_item) @i
        (struct_item) @s
        (enum_item) @e
        (trait_item) @t
        (mod_item) @m
    "#;

    const TS_QUERY: &amp;str = r#"
        (function_declaration) @f
        (class_declaration) @c
        (interface_declaration) @i
        (type_alias_declaration) @t
        (enum_declaration) @e
        (method_definition) @m
        (abstract_class_declaration) @ac
        (module) @mod
    "#;

    const JS_QUERY: &amp;str = r#"
        (function_declaration) @f
        (class_declaration) @c
        (method_definition) @m
    "#;

    const PYTHON_QUERY: &amp;str = r#"
        (function_definition) @f
        (class_definition) @c
    "#;

    const GO_QUERY: &amp;str = r#"
        (function_declaration) @f
        (method_declaration) @m
        (type_declaration) @t
    "#;
}
</file>
<file path="src/security.rs" mode="skeleton">
pub fn is_suspicious(content: &amp;str) -&gt; bool {
    let patterns = [
        r#"(?i)(api_key|apikey|secret|token).{0,20}['|"][0-9a-zA-Z]{32,45}['|"]"#,
        r"ghp_[0-9a-zA-Z]{36}",
        r"sk_live_[0-9a-zA-Z]{24}",
    ];

    for p in patterns {
        if let Ok(re) = Regex::new(p) {
            if re.is_match(content) {
                return true;
            }
        }
    }
    false
}
</file>
<file path="src/output.rs" mode="skeleton">
pub struct ProcessedFile {
    pub path: String,
    pub content: String,
    pub char_count: usize,
    pub token_count: usize,
    // Track if this file is full text (focus) or skeleton (compressed context)
    pub is_skeleton: bool,
}
// ... [implementation details hidden] ...
pub fn generate_output(
    files: &amp;[ProcessedFile],
    config: &amp;RepomixConfig,
    git_diff: Option&lt;&amp;str&gt;,
    git_log: Option&lt;&amp;str&gt;
) -&gt; String {
    match config.output.style {
        OutputStyle::Xml =&gt; generate_xml(files, config, git_diff, git_log),
        OutputStyle::Markdown =&gt; generate_markdown(files, config, git_diff, git_log),
        OutputStyle::Json =&gt; generate_json(files, config, git_diff, git_log),
        OutputStyle::Plain =&gt; generate_plain(files, config, git_diff, git_log),
    }
}
// ... [implementation details hidden] ...
fn generate_xml(files: &amp;[ProcessedFile], config: &amp;RepomixConfig, diff: Option&lt;&amp;str&gt;, log: Option&lt;&amp;str&gt;) -&gt; String {
    let mut out = String::new();
    out.push_str("&lt;repomix&gt;\n");

    if let Some(h) = &amp;config.output.header_text {
        out.push_str(&amp;format!("&lt;header&gt;{}&lt;/header&gt;\n", h));
    }

    out.push_str("&lt;summary&gt;\n");
    out.push_str("  This file is a merged representation of the codebase.\n");
    if let Some(inst) = &amp;config.output.instruction_file_path {
        if let Ok(c) = fs::read_to_string(inst) {
            out.push_str(&amp;format!("&lt;instruction&gt;{}&lt;/instruction&gt;\n", c));
        }
    }
    out.push_str("&lt;/summary&gt;\n");

    out.push_str("&lt;directory_structure&gt;\n");
    for f in files {
        out.push_str(&amp;format!("  {}\n", f.path));
    }
    out.push_str("&lt;/directory_structure&gt;\n");

    out.push_str("&lt;files&gt;\n");
    for f in files {
        let mode = if f.is_skeleton { "skeleton" } else { "full" };
        out.push_str(&amp;format!("&lt;file path=\"{}\" mode=\"{}\"&gt;\n", f.path, mode));
        let content = f.content.replace("&amp;", "&amp;amp;").replace("&lt;", "&amp;lt;").replace("&gt;", "&amp;gt;");
        out.push_str(&amp;content);
        out.push_str("\n&lt;/file&gt;\n");
    }
    out.push_str("&lt;/files&gt;\n");

    if let Some(d) = diff {
        out.push_str("&lt;git_diff&gt;\n");
        out.push_str(d);
        out.push_str("\n&lt;/git_diff&gt;\n");
    }

    if let Some(l) = log {
        out.push_str("&lt;git_log&gt;\n");
        out.push_str(l);
        out.push_str("\n&lt;/git_log&gt;\n");
    }

    out.push_str("&lt;/repomix&gt;");
    out
}
// ... [implementation details hidden] ...
fn generate_markdown(files: &amp;[ProcessedFile], config: &amp;RepomixConfig, diff: Option&lt;&amp;str&gt;, log: Option&lt;&amp;str&gt;) -&gt; String {
    let mut out = String::new();

    if let Some(h) = &amp;config.output.header_text {
        out.push_str(&amp;format!("# {}\n\n", h));
    }

    out.push_str("# File Summary\n\n");
    out.push_str("This file is a merged representation of the codebase.\n\n");

    out.push_str("# Directory Structure\n\n```\n");
    for f in files {
        out.push_str(&amp;format!("{}\n", f.path));
    }
    out.push_str("```\n\n");

    out.push_str("# Files\n\n");
    for f in files {
        let mode = if f.is_skeleton { "SKELETON (Context Only)" } else { "FULL TEXT" };
        out.push_str(&amp;format!("## File: {} [{}]\n", f.path, mode));
        let ext = Path::new(&amp;f.path).extension().and_then(|s| s.to_str()).unwrap_or("");
        out.push_str(&amp;format!("```{}\n", ext));
        out.push_str(&amp;f.content);
        out.push_str("\n```\n\n");
    }

    if let Some(d) = diff {
        out.push_str("# Git Diff\n\n```diff\n");
        out.push_str(d);
        out.push_str("\n```\n\n");
    }

    if let Some(l) = log {
        out.push_str("# Git Log\n\n");
        out.push_str(l);
        out.push_str("\n\n");
    }

    out
}
// ... [implementation details hidden] ...
fn generate_plain(files: &amp;[ProcessedFile], config: &amp;RepomixConfig, diff: Option&lt;&amp;str&gt;, log: Option&lt;&amp;str&gt;) -&gt; String {
    let mut out = String::new();
    let sep = "=".repeat(40);

    out.push_str(&amp;format!("{}\nREPOMIX OUTPUT\n{}\n\n", sep, sep));

    if let Some(h) = &amp;config.output.header_text {
        out.push_str(&amp;format!("HEADER\n{}\n\n", h));
    }

    for f in files {
        out.push_str(&amp;format!("File: {}\n{}\n", f.path, "-".repeat(20)));
        out.push_str(&amp;f.content);
        out.push_str("\n\n");
    }

    if let Some(d) = diff {
        out.push_str(&amp;format!("GIT DIFF\n{}\n{}\n\n", "-".repeat(20), d));
    }

    if let Some(l) = log {
        out.push_str(&amp;format!("GIT LOG\n{}\n{}\n\n", "-".repeat(20), l));
    }

    out
}
// ... [implementation details hidden] ...
fn generate_json(files: &amp;[ProcessedFile], _config: &amp;RepomixConfig, diff: Option&lt;&amp;str&gt;, log: Option&lt;&amp;str&gt;) -&gt; String {
    #[derive(Serialize)]
    struct JsonOutput&lt;'a&gt; {
        files: HashMap&lt;&amp;'a String, &amp;'a String&gt;,
        git_diff: Option&lt;&amp;'a str&gt;,
        git_log: Option&lt;&amp;'a str&gt;,
    }

    let mut file_map = HashMap::new();
    for f in files {
        file_map.insert(&amp;f.path, &amp;f.content);
    }

    let output = JsonOutput {
        files: file_map,
        git_diff: diff,
        git_log: log,
    };

    serde_json::to_string_pretty(&amp;output).unwrap_or_default()
}
</file>
<file path="src/git.rs" mode="skeleton">
pub fn is_git_repo(path: &amp;Path) -&gt; bool {
    Command::new("git")
        .arg("rev-parse")
        .arg("--is-inside-work-tree")
        .current_dir(path)
        .output()
        .map(|o| o.status.success())
        .unwrap_or(false)
}
// ... [implementation details hidden] ...
pub fn clone_repo(url: &amp;str, target: &amp;Path, branch: Option&lt;&amp;str&gt;) -&gt; Result&lt;()&gt; {
    let mut cmd = Command::new("git");
    cmd.arg("clone").arg("--depth").arg("1");

    if let Some(b) = branch {
        cmd.arg("--branch").arg(b);
    }

    cmd.arg(url).arg(target);

    let status = cmd.status().context("Failed to execute git clone")?;
    if !status.success() {
        anyhow::bail!("Git clone failed");
    }
    Ok(())
}
// ... [implementation details hidden] ...
pub fn get_diffs(path: &amp;Path) -&gt; Result&lt;String&gt; {
    let output = Command::new("git")
        .args(["diff", "HEAD"])
        .current_dir(path)
        .output()?;
    Ok(String::from_utf8_lossy(&amp;output.stdout).to_string())
}
// ... [implementation details hidden] ...
pub fn get_logs(path: &amp;Path) -&gt; Result&lt;String&gt; {
    let output = Command::new("git")
        .args(["log", "-n", "50", "--pretty=format:%h - %an, %ar : %s"])
        .current_dir(path)
        .output()?;
    Ok(String::from_utf8_lossy(&amp;output.stdout).to_string())
}
// ... [implementation details hidden] ...
pub fn get_file_change_counts(path: &amp;Path) -&gt; HashMap&lt;String, usize&gt; {
    let output = Command::new("git")
        .args(["log", "--name-only", "--format=", "-n", "100"])
        .current_dir(path)
        .output();

    let mut counts = HashMap::new();
    if let Ok(out) = output {
        let s = String::from_utf8_lossy(&amp;out.stdout);
        for line in s.lines() {
            if !line.trim().is_empty() {
                *counts.entry(line.trim().to_string()).or_insert(0) += 1;
            }
        }
    }
    counts
}
</file>
<file path="src/fs_tools.rs" mode="skeleton">
pub fn count_tokens(content: &amp;str) -&gt; usize {
    let bpe = cl100k_base().unwrap();
    bpe.encode_with_special_tokens(content).len()
}
// ... [implementation details hidden] ...
pub fn is_binary(content: &amp;[u8]) -&gt; bool {
    let len = std::cmp::min(content.len(), 8192);
    content[0..len].contains(&amp;0)
}
</file>
<file path="src/cli.rs" mode="skeleton">
pub struct Cli {
    /// List of directories to process. Defaults to the current directory (".").
    #[arg(default_value = ".")]
    pub directories: Vec&lt;String&gt;,

    /// The output file path. If not specified, output may go to stdout or be generated based on intent.
    #[arg(short, long)]
    pub output: Option&lt;String&gt;,

    /// The output format style.
    #[arg(long, value_enum, default_value_t = OutputStyle::Xml)]
    pub style: OutputStyle,

    /// [Deprecated] Enable a machine-parsable style if applicable.
    #[arg(long)]
    pub parsable_style: bool,

    /// Path to a specific configuration file (e.g., repomix.config.json).
    #[arg(short, long)]
    pub config: Option&lt;String&gt;,

    /// Copy the generated output to the system clipboard.
    #[arg(long)]
    pub copy: bool,

    /// Enable verbose logging for debugging purposes.
    #[arg(long)]
    pub verbose: bool,

    /// The number of "top files" to display in the summary (based on some metric like modification count).
    #[arg(long)]
    pub top_files_len: Option&lt;usize&gt;,

    /// Add line numbers to the source code in the output.
    #[arg(long)]
    pub output_show_line_numbers: bool,

    /// Remove comments from the source code (supported languages only).
    #[arg(long)]
    pub remove_comments: bool,

    /// Remove empty lines to compact the code.
    #[arg(long)]
    pub remove_empty_lines: bool,

    /// aggressively compress the code (remove extra whitespace, newlines, etc.).
    #[arg(long)]
    pub compress: bool,

    /// Include empty directories in the file listing.
    #[arg(long)]
    pub include_empty_directories: bool,

    /// A remote repository URL to clone and process.
    #[arg(long)]
    pub remote: Option&lt;String&gt;,

    /// The branch to check out for the remote repository.
    #[arg(long)]
    pub remote_branch: Option&lt;String&gt;,

    /// Enable or disable the security check for suspicious content (e.g. secrets).
    #[arg(long)]
    pub security_check: Option&lt;bool&gt;,

    /// Additional glob patterns to include (overriding ignores).
    #[arg(long)]
    pub include: Option&lt;String&gt;,

    /// Additional glob patterns to ignore.
    #[arg(short, long)]
    pub ignore: Option&lt;String&gt;,

    /// Disable the use of .gitignore files.
    #[arg(long)]
    pub no_gitignore: bool,

    /// Disable default ignore patterns entry (e.g. .git, node_modules).
    #[arg(long)]
    pub no_default_patterns: bool,

    /// Custom text to include in the header of the output.
    #[arg(long)]
    pub header_text: Option&lt;String&gt;,

    /// Path to a file containing instructions/text to include in the header.
    #[arg(long)]
    pub instruction_file_path: Option&lt;String&gt;,

    /// Include git diffs in the output (if in a git repository).
    #[arg(long)]
    pub include_diffs: bool,

    /// Include git log history in the output (if in a git repository).
    #[arg(long)]
    pub include_logs: bool,

    // --- NEW ARGUMENTS ---

    /// The specific task you want the LLM to perform.
    /// If provided, this generates a custom prompt at the top of the file.
    #[arg(long)]
    pub intent: Option&lt;String&gt;,

    /// A comma-separated list of files to include in FULL TEXT, overriding compression.
    /// Example: --focus "src/main.rs,src/utils.rs"
    #[arg(long)]
    pub focus: Option&lt;String&gt;,
}
// ... [implementation details hidden] ...
pub enum OutputStyle {
    Xml,
    Markdown,
    Json,
    Plain,
}
</file>
<file path="README.md" mode="skeleton">
# Rustymix ü¶Ä

**Rustymix** is a high-performance, native Rust port of [Repomix](https://github.com/yamadashy/repomix), evolved into a **Context Intelligence Engine** for LLMs.

It doesn't just pack files; it curates context. It allows you to feed LLMs a lightweight "Skeleton" of your entire repo to identify relevant files, then generates a "Hybrid" pack containing **full source code** for the files you need to edit, while keeping the rest as **compressed signatures** to prevent hallucinations.

## üöÄ Features

- **Context Intelligence**: Hybrid packing allows you to mix "Full Text" (focused files) and "Skeleton" (compressed context) in a single output.
- **Smart Prompt Injection**: Automatically attaches your intent ("Fix the login bug") and instructions to the top of the generated file.
- **Blazing Fast**: Written in Rust using Tokio and the `ripgrep` engine (`ignore`) for instant file walking.
- **Tree-sitter Compression**: Parses code to strip implementation details from non-focus files, saving 40-60% of tokens while retaining type safety.
- **Security Check**: Automatically detects and excludes suspicious secrets (API keys, tokens).
- **Git Aware**: Respects `.gitignore`, supports remote repo cloning, and includes git diffs/logs.
- **Clipboard Ready**: Copies the output directly to your system clipboard.

## üì¶ Installation

### From Source
```bash
git clone [https://github.com/yourusername/rustymix](https://github.com/yourusername/rustymix)
cd rustymix
cargo install --path .
````

## üß† The "Smart Context" Workflow

Rustymix is designed for a 2-pass workflow that saves money and improves LLM accuracy.

### Phase 1: Survey (The "Map")

Ask the LLM what it needs to look at. Rustymix generates a **Skeleton** of your entire repo and injects a prompt asking the LLM to identify relevant files.

```bash
rustymix --compress --intent "There is a bug in the login retry logic. Which files do I need to fix it?"
```

**Output sent to LLM:**

&gt; **System:** Attached is the SKELETON of the codebase. Return a list of file paths that must be read in full text.
&gt; **Context:** `src/auth/login.ts` (signatures only), `src/utils/retry.ts` (signatures only)...

**LLM Response:**

&gt; "I need to see `src/auth/login.ts` and `src/utils/retry.ts`."

-----

### Phase 2: Build (The "Pack")

Feed the LLM exactly what it asked for. Use the `--focus` flag to give it full access to specific files while keeping the rest of the repo as a skeleton for context.

```bash
rustymix --focus "src/auth/login.ts,src/utils/retry.ts" --compress --intent "Fix the retry logic bug."
```

**Output sent to LLM:**

&gt; **System:** Attached is the CONTEXT PACK. Files marked `mode="full"` are editable. Files marked `mode="skeleton"` are read-only context.
&gt; **File 1:** `src/auth/login.ts` (FULL TEXT)
&gt; **File 2:** `src/utils/retry.ts` (FULL TEXT)
&gt; **File 3:** `src/database/db.ts` (SKELETON - Context only)

## üõ† Usage

### Common Commands

```bash
# Standard pack (everything in full text)
rustymix

# Output to Markdown and copy to clipboard
rustymix --style markdown --copy

# Process a remote repository
rustymix --remote [https://github.com/yamadashy/repomix](https://github.com/yamadashy/repomix) --output repomix-source.xml
```

### All Flags

| Flag | Description |
|------|-------------|
| `--intent &lt;TEXT&gt;` | **(New)** Injects your natural language task at the top of the file to guide the LLM. |
| `--focus &lt;FILES&gt;` | **(New)** Comma-separated list of files to include in **Full Text**. All other files respect the `--compress` flag. |
| `--compress` | Uses Tree-sitter to strip implementation details from files not in `--focus`. |
| `-o, --output &lt;FILE&gt;` | Output file path (default: `repomix-output.xml`). |
| `--style &lt;STYLE&gt;` | Output style: `xml`, `markdown`, `json`, `plain`. |
| `--copy` | Copy output to system clipboard. |
| `--remote &lt;URL&gt;` | Process a remote Git repository. |
| `--security-check &lt;BOOL&gt;` | Enable/Disable secret scanning (default: true). |
| `--include &lt;PATTERN&gt;` | Comma-separated glob patterns to include. |
| `--ignore &lt;PATTERN&gt;` | Comma-separated glob patterns to ignore. |
| `--include-diffs` | Include `git diff` (staged and unstaged) in output. |
| `--include-logs` | Include recent `git log` in output. |

## ‚öôÔ∏è Configuration

Rustymix automatically detects `repomix.config.json` in your project root.

```json
{
  "output": {
    "style": "markdown",
    "removeComments": true,
    "compress": true,
    "topFilesLength": 10
  },
  "ignore": {
    "customPatterns": ["**/*.test.ts", "legacy/**"]
  },
  "security": {
    "enableSecurityCheck": true
  }
}
```

*Note: `--focus` and `--intent` are currently CLI-only arguments to ensure they are specific to the current task.*

## üÜö Comparison

| Feature | Original Repomix (Node) | Rustymix (Rust) |
|---------|-------------------------|-----------------|
| **Philosophy** | "Pack everything" | "Smart Context" |
| **Hybrid Packing** | No | **Yes** (Focus + Compress) |
| **Prompt Injection**| No | **Yes** (via `--intent`) |
| **Runtime** | Node.js | Native Binary |
| **Startup Speed** | Slow (\~500ms+) | Instant (\~10ms) |
| **Parser** | Tree-sitter (WASM) | Tree-sitter (Native C) |

## üìÑ License

MIT

</file>
<file path="Cargo.lock" mode="skeleton">
# This file is automatically @generated by Cargo.
# It is not intended for manual editing.
version = 4

[[package]]
name = "adler2"
version = "2.0.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "320119579fcad9c21884f5c4861d16174d0e06250625266f50fe6898340abefa"

[[package]]
name = "aho-corasick"
version = "1.1.4"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "ddd31a130427c27518df266943a5308ed92d4b226cc639f5a8f1002816174301"
dependencies = [
 "memchr",
]

[[package]]
name = "anstream"
version = "0.6.21"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "43d5b281e737544384e969a5ccad3f1cdd24b48086a0fc1b2a5262a26b8f4f4a"
dependencies = [
 "anstyle",
 "anstyle-parse",
 "anstyle-query",
 "anstyle-wincon",
 "colorchoice",
 "is_terminal_polyfill",
 "utf8parse",
]

[[package]]
name = "anstyle"
version = "1.0.13"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "5192cca8006f1fd4f7237516f40fa183bb07f8fbdfedaa0036de5ea9b0b45e78"

[[package]]
name = "anstyle-parse"
version = "0.2.7"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "4e7644824f0aa2c7b9384579234ef10eb7efb6a0deb83f9630a49594dd9c15c2"
dependencies = [
 "utf8parse",
]

[[package]]
name = "anstyle-query"
version = "1.1.5"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "40c48f72fd53cd289104fc64099abca73db4166ad86ea0b4341abe65af83dadc"
dependencies = [
 "windows-sys 0.61.2",
]

[[package]]
name = "anstyle-wincon"
version = "3.0.11"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "291e6a250ff86cd4a820112fb8898808a366d8f9f58ce16d1f538353ad55747d"
dependencies = [
 "anstyle",
 "once_cell_polyfill",
 "windows-sys 0.61.2",
]

[[package]]
name = "anyhow"
version = "1.0.100"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "a23eb6b1614318a8071c9b2521f36b424b2c83db5eb3a0fead4a6c0809af6e61"

[[package]]
name = "arboard"
version = "3.6.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "0348a1c054491f4bfe6ab86a7b6ab1e44e45d899005de92f58b3df180b36ddaf"
dependencies = [
 "clipboard-win",
 "image",
 "log",
 "objc2",
 "objc2-app-kit",
 "objc2-core-foundation",
 "objc2-core-graphics",
 "objc2-foundation",
 "parking_lot",
 "percent-encoding",
 "windows-sys 0.60.2",
 "x11rb",
]

[[package]]
name = "assert_cmd"
version = "2.1.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "bcbb6924530aa9e0432442af08bbcafdad182db80d2e560da42a6d442535bf85"
dependencies = [
 "anstyle",
 "bstr",
 "libc",
 "predicates",
 "predicates-core",
 "predicates-tree",
 "wait-timeout",
]

[[package]]
name = "autocfg"
version = "1.5.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "c08606f8c3cbf4ce6ec8e28fb0014a2c086708fe954eaa885384a6165172e7e8"

[[package]]
name = "base64"
version = "0.21.7"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "9d297deb1925b89f2ccc13d7635fa0714f12c87adce1c75356b39ca9b7178567"

[[package]]
name = "bit-set"
version = "0.5.3"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "0700ddab506f33b20a03b13996eccd309a48e5ff77d0d95926aa0210fb4e95f1"
dependencies = [
 "bit-vec",
]

[[package]]
name = "bit-vec"
version = "0.6.3"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "349f9b6a179ed607305526ca489b34ad0a41aed5f7980fa90eb03160b69598fb"

[[package]]
name = "bitflags"
version = "2.10.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "812e12b5285cc515a9c72a5c1d3b6d46a19dac5acfef5265968c166106e31dd3"

[[package]]
name = "bstr"
version = "1.12.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "63044e1ae8e69f3b5a92c736ca6269b8d12fa7efe39bf34ddb06d102cf0e2cab"
dependencies = [
 "memchr",
 "regex-automata",
 "serde",
]

[[package]]
name = "bumpalo"
version = "3.19.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "46c5e41b57b8bba42a04676d81cb89e9ee8e859a1a66f80a5a72e1cb76b34d43"

[[package]]
name = "bytemuck"
version = "1.24.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "1fbdf580320f38b612e485521afda1ee26d10cc9884efaaa750d383e13e3c5f4"

[[package]]
name = "byteorder-lite"
version = "0.1.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "8f1fe948ff07f4bd06c30984e69f5b4899c516a3ef74f34df92a2df2ab535495"

[[package]]
name = "bytes"
version = "1.11.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "b35204fbdc0b3f4446b89fc1ac2cf84a8a68971995d0bf2e925ec7cd960f9cb3"

[[package]]
name = "cc"
version = "1.2.48"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "c481bdbf0ed3b892f6f806287d72acd515b352a4ec27a208489b8c1bc839633a"
dependencies = [
 "find-msvc-tools",
 "shlex",
]

[[package]]
name = "cfg-if"
version = "1.0.4"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "9330f8b2ff13f34540b44e946ef35111825727b38d33286ef986142615121801"

[[package]]
name = "clap"
version = "4.5.53"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "c9e340e012a1bf4935f5282ed1436d1489548e8f72308207ea5df0e23d2d03f8"
dependencies = [
 "clap_builder",
 "clap_derive",
]

[[package]]
name = "clap_builder"
version = "4.5.53"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "d76b5d13eaa18c901fd2f7fca939fefe3a0727a953561fefdf3b2922b8569d00"
dependencies = [
 "anstream",
 "anstyle",
 "clap_lex",
 "strsim",
]

[[package]]
name = "clap_derive"
version = "4.5.49"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "2a0b5487afeab2deb2ff4e03a807ad1a03ac532ff5a2cee5d86884440c7f7671"
dependencies = [
 "heck",
 "proc-macro2",
 "quote",
 "syn",
]

[[package]]
name = "clap_lex"
version = "0.7.6"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "a1d728cc89cf3aee9ff92b05e62b19ee65a02b5702cff7d5a377e32c6ae29d8d"

[[package]]
name = "clipboard-win"
version = "5.4.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "bde03770d3df201d4fb868f2c9c59e66a3e4e2bd06692a0fe701e7103c7e84d4"
dependencies = [
 "error-code",
]

[[package]]
name = "colorchoice"
version = "1.0.4"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "b05b61dc5112cbb17e4b6cd61790d9845d13888356391624cbe7e41efeac1e75"

[[package]]
name = "console"
version = "0.15.11"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "054ccb5b10f9f2cbf51eb355ca1d05c2d279ce1804688d0db74b4733a5aeafd8"
dependencies = [
 "encode_unicode",
 "libc",
 "once_cell",
 "unicode-width",
 "windows-sys 0.59.0",
]

[[package]]
name = "crc32fast"
version = "1.5.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "9481c1c90cbf2ac953f07c8d4a58aa3945c425b7185c9154d67a65e4230da511"
dependencies = [
 "cfg-if",
]

[[package]]
name = "crossbeam-deque"
version = "0.8.6"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "9dd111b7b7f7d55b72c0a6ae361660ee5853c9af73f70c3c2ef6858b950e2e51"
dependencies = [
 "crossbeam-epoch",
 "crossbeam-utils",
]

[[package]]
name = "crossbeam-epoch"
version = "0.9.18"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "5b82ac4a3c2ca9c3460964f020e1402edd5753411d7737aa39c3714ad1b5420e"
dependencies = [
 "crossbeam-utils",
]

[[package]]
name = "crossbeam-utils"
version = "0.8.21"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "d0a5c400df2834b80a4c3327b3aad3a4c4cd4de0629063962b03235697506a28"

[[package]]
name = "crunchy"
version = "0.2.4"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "460fbee9c2c2f33933d720630a6a0bac33ba7053db5344fac858d4b8952d77d5"

[[package]]
name = "difflib"
version = "0.4.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "6184e33543162437515c2e2b48714794e37845ec9851711914eec9d308f6ebe8"

[[package]]
name = "dispatch2"
version = "0.3.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "89a09f22a6c6069a18470eb92d2298acf25463f14256d24778e1230d789a2aec"
dependencies = [
 "bitflags",
 "objc2",
]

[[package]]
name = "encode_unicode"
version = "1.0.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "34aa73646ffb006b8f5147f3dc182bd4bcb190227ce861fc4a4844bf8e3cb2c0"

[[package]]
name = "errno"
version = "0.3.14"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "39cab71617ae0d63f51a36d69f866391735b51691dbda63cf6f96d042b63efeb"
dependencies = [
 "libc",
 "windows-sys 0.61.2",
]

[[package]]
name = "error-code"
version = "3.3.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "dea2df4cf52843e0452895c455a1a2cfbb842a1e7329671acf418fdc53ed4c59"

[[package]]
name = "fancy-regex"
version = "0.12.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "7493d4c459da9f84325ad297371a6b2b8a162800873a22e3b6b6512e61d18c05"
dependencies = [
 "bit-set",
 "regex",
]

[[package]]
name = "fastrand"
version = "2.3.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "37909eebbb50d72f9059c3b6d82c0463f2ff062c9e95845c43a6c9c0355411be"

[[package]]
name = "fax"
version = "0.2.6"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "f05de7d48f37cd6730705cbca900770cab77a89f413d23e100ad7fad7795a0ab"
dependencies = [
 "fax_derive",
]

[[package]]
name = "fax_derive"
version = "0.2.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "a0aca10fb742cb43f9e7bb8467c91aa9bcb8e3ffbc6a6f7389bb93ffc920577d"
dependencies = [
 "proc-macro2",
 "quote",
 "syn",
]

[[package]]
name = "fdeflate"
version = "0.3.7"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "1e6853b52649d4ac5c0bd02320cddc5ba956bdb407c4b75a2c6b75bf51500f8c"
dependencies = [
 "simd-adler32",
]

[[package]]
name = "find-msvc-tools"
version = "0.1.5"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "3a3076410a55c90011c298b04d0cfa770b00fa04e1e3c97d3f6c9de105a03844"

[[package]]
name = "flate2"
version = "1.1.5"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "bfe33edd8e85a12a67454e37f8c75e730830d83e313556ab9ebf9ee7fbeb3bfb"
dependencies = [
 "crc32fast",
 "miniz_oxide",
]

[[package]]
name = "float-cmp"
version = "0.10.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "b09cf3155332e944990140d967ff5eceb70df778b34f77d8075db46e4704e6d8"
dependencies = [
 "num-traits",
]

[[package]]
name = "gethostname"
version = "1.1.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "1bd49230192a3797a9a4d6abe9b3eed6f7fa4c8a8a4947977c6f80025f92cbd8"
dependencies = [
 "rustix",
 "windows-link",
]

[[package]]
name = "getrandom"
version = "0.3.4"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "899def5c37c4fd7b2664648c28120ecec138e4d395b459e5ca34f9cce2dd77fd"
dependencies = [
 "cfg-if",
 "libc",
 "r-efi",
 "wasip2",
]

[[package]]
name = "globset"
version = "0.4.18"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "52dfc19153a48bde0cbd630453615c8151bce3a5adfac7a0aebfbf0a1e1f57e3"
dependencies = [
 "aho-corasick",
 "bstr",
 "log",
 "regex-automata",
 "regex-syntax",
]

[[package]]
name = "half"
version = "2.7.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "6ea2d84b969582b4b1864a92dc5d27cd2b77b622a8d79306834f1be5ba20d84b"
dependencies = [
 "cfg-if",
 "crunchy",
 "zerocopy",
]

[[package]]
name = "heck"
version = "0.5.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "2304e00983f87ffb38b55b444b5e3b60a884b5d30c0fca7d82fe33449bbe55ea"

[[package]]
name = "ignore"
version = "0.4.25"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "d3d782a365a015e0f5c04902246139249abf769125006fbe7649e2ee88169b4a"
dependencies = [
 "crossbeam-deque",
 "globset",
 "log",
 "memchr",
 "regex-automata",
 "same-file",
 "walkdir",
 "winapi-util",
]

[[package]]
name = "image"
version = "0.25.9"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "e6506c6c10786659413faa717ceebcb8f70731c0a60cbae39795fdf114519c1a"
dependencies = [
 "bytemuck",
 "byteorder-lite",
 "moxcms",
 "num-traits",
 "png",
 "tiff",
]

[[package]]
name = "indicatif"
version = "0.17.11"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "183b3088984b400f4cfac3620d5e076c84da5364016b4f49473de574b2586235"
dependencies = [
 "console",
 "number_prefix",
 "portable-atomic",
 "unicode-width",
 "web-time",
]

[[package]]
name = "is_terminal_polyfill"
version = "1.70.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "a6cb138bb79a146c1bd460005623e142ef0181e3d0219cb493e02f7d08a35695"

[[package]]
name = "itoa"
version = "1.0.15"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "4a5f13b858c8d314ee3e8f639011f7ccefe71f97f96e50151fb991f267928e2c"

[[package]]
name = "js-sys"
version = "0.3.83"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "464a3709c7f55f1f721e5389aa6ea4e3bc6aba669353300af094b29ffbdde1d8"
dependencies = [
 "once_cell",
 "wasm-bindgen",
]

[[package]]
name = "lazy_static"
version = "1.5.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "bbd2bcb4c963f2ddae06a2efc7e9f3591312473c50c6685e1f298068316e66fe"

[[package]]
name = "libc"
version = "0.2.178"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "37c93d8daa9d8a012fd8ab92f088405fb202ea0b6ab73ee2482ae66af4f42091"

[[package]]
name = "linux-raw-sys"
version = "0.11.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "df1d3c3b53da64cf5760482273a98e575c651a67eec7f77df96b5b642de8f039"

[[package]]
name = "lock_api"
version = "0.4.14"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "224399e74b87b5f3557511d98dff8b14089b3dadafcab6bb93eab67d3aace965"
dependencies = [
 "scopeguard",
]

[[package]]
name = "log"
version = "0.4.29"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "5e5032e24019045c762d3c0f28f5b6b8bbf38563a65908389bf7978758920897"

[[package]]
name = "memchr"
version = "2.7.6"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "f52b00d39961fc5b2736ea853c9cc86238e165017a493d1d5c8eac6bdc4cc273"

[[package]]
name = "miniz_oxide"
version = "0.8.9"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "1fa76a2c86f704bdb222d66965fb3d63269ce38518b83cb0575fca855ebb6316"
dependencies = [
 "adler2",
 "simd-adler32",
]

[[package]]
name = "mio"
version = "1.1.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "a69bcab0ad47271a0234d9422b131806bf3968021e5dc9328caf2d4cd58557fc"
dependencies = [
 "libc",
 "wasi",
 "windows-sys 0.61.2",
]

[[package]]
name = "moxcms"
version = "0.7.10"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "80986bbbcf925ebd3be54c26613d861255284584501595cf418320c078945608"
dependencies = [
 "num-traits",
 "pxfm",
]

[[package]]
name = "normalize-line-endings"
version = "0.3.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "61807f77802ff30975e01f4f071c8ba10c022052f98b3294119f3e615d13e5be"

[[package]]
name = "num-traits"
version = "0.2.19"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "071dfc062690e90b734c0b2273ce72ad0ffa95f0c74596bc250dcfd960262841"
dependencies = [
 "autocfg",
]

[[package]]
name = "number_prefix"
version = "0.4.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "830b246a0e5f20af87141b25c173cd1b609bd7779a4617d6ec582abaf90870f3"

[[package]]
name = "objc2"
version = "0.6.3"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "b7c2599ce0ec54857b29ce62166b0ed9b4f6f1a70ccc9a71165b6154caca8c05"
dependencies = [
 "objc2-encode",
]

[[package]]
name = "objc2-app-kit"
version = "0.3.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "d49e936b501e5c5bf01fda3a9452ff86dc3ea98ad5f283e1455153142d97518c"
dependencies = [
 "bitflags",
 "objc2",
 "objc2-core-graphics",
 "objc2-foundation",
]

[[package]]
name = "objc2-core-foundation"
version = "0.3.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "2a180dd8642fa45cdb7dd721cd4c11b1cadd4929ce112ebd8b9f5803cc79d536"
dependencies = [
 "bitflags",
 "dispatch2",
 "objc2",
]

[[package]]
name = "objc2-core-graphics"
version = "0.3.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "e022c9d066895efa1345f8e33e584b9f958da2fd4cd116792e15e07e4720a807"
dependencies = [
 "bitflags",
 "dispatch2",
 "objc2",
 "objc2-core-foundation",
 "objc2-io-surface",
]

[[package]]
name = "objc2-encode"
version = "4.1.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "ef25abbcd74fb2609453eb695bd2f860d389e457f67dc17cafc8b8cbc89d0c33"

[[package]]
name = "objc2-foundation"
version = "0.3.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "e3e0adef53c21f888deb4fa59fc59f7eb17404926ee8a6f59f5df0fd7f9f3272"
dependencies = [
 "bitflags",
 "objc2",
 "objc2-core-foundation",
]

[[package]]
name = "objc2-io-surface"
version = "0.3.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "180788110936d59bab6bd83b6060ffdfffb3b922ba1396b312ae795e1de9d81d"
dependencies = [
 "bitflags",
 "objc2",
 "objc2-core-foundation",
]

[[package]]
name = "once_cell"
version = "1.21.3"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "42f5e15c9953c5e4ccceeb2e7382a716482c34515315f7b03532b8b4e8393d2d"

[[package]]
name = "once_cell_polyfill"
version = "1.70.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "384b8ab6d37215f3c5301a95a4accb5d64aa607f1fcb26a11b5303878451b4fe"

[[package]]
name = "parking_lot"
version = "0.12.5"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "93857453250e3077bd71ff98b6a65ea6621a19bb0f559a85248955ac12c45a1a"
dependencies = [
 "lock_api",
 "parking_lot_core",
]

[[package]]
name = "parking_lot_core"
version = "0.9.12"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "2621685985a2ebf1c516881c026032ac7deafcda1a2c9b7850dc81e3dfcb64c1"
dependencies = [
 "cfg-if",
 "libc",
 "redox_syscall",
 "smallvec",
 "windows-link",
]

[[package]]
name = "pathdiff"
version = "0.2.3"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "df94ce210e5bc13cb6651479fa48d14f601d9858cfe0467f43ae157023b938d3"

[[package]]
name = "percent-encoding"
version = "2.3.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "9b4f627cb1b25917193a259e49bdad08f671f8d9708acfd5fe0a8c1455d87220"

[[package]]
name = "pin-project-lite"
version = "0.2.16"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "3b3cff922bd51709b605d9ead9aa71031d81447142d828eb4a6eba76fe619f9b"

[[package]]
name = "png"
version = "0.18.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "97baced388464909d42d89643fe4361939af9b7ce7a31ee32a168f832a70f2a0"
dependencies = [
 "bitflags",
 "crc32fast",
 "fdeflate",
 "flate2",
 "miniz_oxide",
]

[[package]]
name = "portable-atomic"
version = "1.11.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "f84267b20a16ea918e43c6a88433c2d54fa145c92a811b5b047ccbe153674483"

[[package]]
name = "predicates"
version = "3.1.3"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "a5d19ee57562043d37e82899fade9a22ebab7be9cef5026b07fda9cdd4293573"
dependencies = [
 "anstyle",
 "difflib",
 "float-cmp",
 "normalize-line-endings",
 "predicates-core",
 "regex",
]

[[package]]
name = "predicates-core"
version = "1.0.9"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "727e462b119fe9c93fd0eb1429a5f7647394014cf3c04ab2c0350eeb09095ffa"

[[package]]
name = "predicates-tree"
version = "1.0.12"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "72dd2d6d381dfb73a193c7fca536518d7caee39fc8503f74e7dc0be0531b425c"
dependencies = [
 "predicates-core",
 "termtree",
]

[[package]]
name = "proc-macro2"
version = "1.0.103"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "5ee95bc4ef87b8d5ba32e8b7714ccc834865276eab0aed5c9958d00ec45f49e8"
dependencies = [
 "unicode-ident",
]

[[package]]
name = "pxfm"
version = "0.1.26"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "b3502d6155304a4173a5f2c34b52b7ed0dd085890326cb50fd625fdf39e86b3b"
dependencies = [
 "num-traits",
]

[[package]]
name = "quick-error"
version = "2.0.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "a993555f31e5a609f617c12db6250dedcac1b0a85076912c436e6fc9b2c8e6a3"

[[package]]
name = "quote"
version = "1.0.42"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "a338cc41d27e6cc6dce6cefc13a0729dfbb81c262b1f519331575dd80ef3067f"
dependencies = [
 "proc-macro2",
]

[[package]]
name = "r-efi"
version = "5.3.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "69cdb34c158ceb288df11e18b4bd39de994f6657d83847bdffdbd7f346754b0f"

[[package]]
name = "redox_syscall"
version = "0.5.18"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "ed2bf2547551a7053d6fdfafda3f938979645c44812fbfcda098faae3f1a362d"
dependencies = [
 "bitflags",
]

[[package]]
name = "regex"
version = "1.12.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "843bc0191f75f3e22651ae5f1e72939ab2f72a4bc30fa80a066bd66edefc24d4"
dependencies = [
 "aho-corasick",
 "memchr",
 "regex-automata",
 "regex-syntax",
]

[[package]]
name = "regex-automata"
version = "0.4.13"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "5276caf25ac86c8d810222b3dbb938e512c55c6831a10f3e6ed1c93b84041f1c"
dependencies = [
 "aho-corasick",
 "memchr",
 "regex-syntax",
]

[[package]]
name = "regex-syntax"
version = "0.8.8"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "7a2d987857b319362043e95f5353c0535c1f58eec5336fdfcf626430af7def58"

[[package]]
name = "rustc-hash"
version = "1.1.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "08d43f7aa6b08d49f382cde6a7982047c3426db949b1424bc4b7ec9ae12c6ce2"

[[package]]
name = "rustix"
version = "1.1.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "cd15f8a2c5551a84d56efdc1cd049089e409ac19a3072d5037a17fd70719ff3e"
dependencies = [
 "bitflags",
 "errno",
 "libc",
 "linux-raw-sys",
 "windows-sys 0.61.2",
]

[[package]]
name = "rustversion"
version = "1.0.22"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "b39cdef0fa800fc44525c84ccb54a029961a8215f9619753635a9c0d2538d46d"

[[package]]
name = "rustymix"
version = "0.1.0"
dependencies = [
 "anyhow",
 "arboard",
 "assert_cmd",
 "clap",
 "globset",
 "ignore",
 "indicatif",
 "pathdiff",
 "predicates",
 "regex",
 "serde",
 "serde_json",
 "streaming-iterator",
 "tempfile",
 "tiktoken-rs",
 "tokio",
 "tree-sitter",
 "tree-sitter-go",
 "tree-sitter-javascript",
 "tree-sitter-python",
 "tree-sitter-rust",
 "tree-sitter-typescript",
]

[[package]]
name = "ryu"
version = "1.0.20"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "28d3b2b1366ec20994f1fd18c3c594f05c5dd4bc44d8bb0c1c632c8d6829481f"

[[package]]
name = "same-file"
version = "1.0.6"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "93fc1dc3aaa9bfed95e02e6eadabb4baf7e3078b0bd1b4d7b6b0b68378900502"
dependencies = [
 "winapi-util",
]

[[package]]
name = "scopeguard"
version = "1.2.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "94143f37725109f92c262ed2cf5e59bce7498c01bcc1502d7b9afe439a4e9f49"

[[package]]
name = "serde"
version = "1.0.228"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "9a8e94ea7f378bd32cbbd37198a4a91436180c5bb472411e48b5ec2e2124ae9e"
dependencies = [
 "serde_core",
 "serde_derive",
]

[[package]]
name = "serde_core"
version = "1.0.228"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "41d385c7d4ca58e59fc732af25c3983b67ac852c1a25000afe1175de458b67ad"
dependencies = [
 "serde_derive",
]

[[package]]
name = "serde_derive"
version = "1.0.228"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "d540f220d3187173da220f885ab66608367b6574e925011a9353e4badda91d79"
dependencies = [
 "proc-macro2",
 "quote",
 "syn",
]

[[package]]
name = "serde_json"
version = "1.0.145"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "402a6f66d8c709116cf22f558eab210f5a50187f702eb4d7e5ef38d9a7f1c79c"
dependencies = [
 "itoa",
 "memchr",
 "ryu",
 "serde",
 "serde_core",
]

[[package]]
name = "shlex"
version = "1.3.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "0fda2ff0d084019ba4d7c6f371c95d8fd75ce3524c3cb8fb653a3023f6323e64"

[[package]]
name = "signal-hook-registry"
version = "1.4.7"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "7664a098b8e616bdfcc2dc0e9ac44eb231eedf41db4e9fe95d8d32ec728dedad"
dependencies = [
 "libc",
]

[[package]]
name = "simd-adler32"
version = "0.3.7"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "d66dc143e6b11c1eddc06d5c423cfc97062865baf299914ab64caa38182078fe"

[[package]]
name = "smallvec"
version = "1.15.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "67b1b7a3b5fe4f1376887184045fcf45c69e92af734b7aaddc05fb777b6fbd03"

[[package]]
name = "socket2"
version = "0.6.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "17129e116933cf371d018bb80ae557e889637989d8638274fb25622827b03881"
dependencies = [
 "libc",
 "windows-sys 0.60.2",
]

[[package]]
name = "streaming-iterator"
version = "0.1.9"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "2b2231b7c3057d5e4ad0156fb3dc807d900806020c5ffa3ee6ff2c8c76fb8520"

[[package]]
name = "strsim"
version = "0.11.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "7da8b5736845d9f2fcb837ea5d9e2628564b3b043a70948a3f0b778838c5fb4f"

[[package]]
name = "syn"
version = "2.0.111"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "390cc9a294ab71bdb1aa2e99d13be9c753cd2d7bd6560c77118597410c4d2e87"
dependencies = [
 "proc-macro2",
 "quote",
 "unicode-ident",
]

[[package]]
name = "tempfile"
version = "3.23.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "2d31c77bdf42a745371d260a26ca7163f1e0924b64afa0b688e61b5a9fa02f16"
dependencies = [
 "fastrand",
 "getrandom",
 "once_cell",
 "rustix",
 "windows-sys 0.61.2",
]

[[package]]
name = "termtree"
version = "0.5.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "8f50febec83f5ee1df3015341d8bd429f2d1cc62bcba7ea2076759d315084683"

[[package]]
name = "tiff"
version = "0.10.3"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "af9605de7fee8d9551863fd692cce7637f548dbd9db9180fcc07ccc6d26c336f"
dependencies = [
 "fax",
 "flate2",
 "half",
 "quick-error",
 "weezl",
 "zune-jpeg",
]

[[package]]
name = "tiktoken-rs"
version = "0.5.9"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "c314e7ce51440f9e8f5a497394682a57b7c323d0f4d0a6b1b13c429056e0e234"
dependencies = [
 "anyhow",
 "base64",
 "bstr",
 "fancy-regex",
 "lazy_static",
 "parking_lot",
 "rustc-hash",
]

[[package]]
name = "tokio"
version = "1.48.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "ff360e02eab121e0bc37a2d3b4d4dc622e6eda3a8e5253d5435ecf5bd4c68408"
dependencies = [
 "bytes",
 "libc",
 "mio",
 "parking_lot",
 "pin-project-lite",
 "signal-hook-registry",
 "socket2",
 "tokio-macros",
 "windows-sys 0.61.2",
]

[[package]]
name = "tokio-macros"
version = "2.6.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "af407857209536a95c8e56f8231ef2c2e2aff839b22e07a1ffcbc617e9db9fa5"
dependencies = [
 "proc-macro2",
 "quote",
 "syn",
]

[[package]]
name = "tree-sitter"
version = "0.24.7"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "a5387dffa7ffc7d2dae12b50c6f7aab8ff79d6210147c6613561fc3d474c6f75"
dependencies = [
 "cc",
 "regex",
 "regex-syntax",
 "streaming-iterator",
 "tree-sitter-language",
]

[[package]]
name = "tree-sitter-go"
version = "0.23.4"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "b13d476345220dbe600147dd444165c5791bf85ef53e28acbedd46112ee18431"
dependencies = [
 "cc",
 "tree-sitter-language",
]

[[package]]
name = "tree-sitter-javascript"
version = "0.23.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "bf40bf599e0416c16c125c3cec10ee5ddc7d1bb8b0c60fa5c4de249ad34dc1b1"
dependencies = [
 "cc",
 "tree-sitter-language",
]

[[package]]
name = "tree-sitter-language"
version = "0.1.5"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "c4013970217383f67b18aef68f6fb2e8d409bc5755227092d32efb0422ba24b8"

[[package]]
name = "tree-sitter-python"
version = "0.23.6"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "3d065aaa27f3aaceaf60c1f0e0ac09e1cb9eb8ed28e7bcdaa52129cffc7f4b04"
dependencies = [
 "cc",
 "tree-sitter-language",
]

[[package]]
name = "tree-sitter-rust"
version = "0.23.3"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "ca8ccb3e3a3495c8a943f6c3fd24c3804c471fd7f4f16087623c7fa4c0068e8a"
dependencies = [
 "cc",
 "tree-sitter-language",
]

[[package]]
name = "tree-sitter-typescript"
version = "0.23.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "6c5f76ed8d947a75cc446d5fccd8b602ebf0cde64ccf2ffa434d873d7a575eff"
dependencies = [
 "cc",
 "tree-sitter-language",
]

[[package]]
name = "unicode-ident"
version = "1.0.22"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "9312f7c4f6ff9069b165498234ce8be658059c6728633667c526e27dc2cf1df5"

[[package]]
name = "unicode-width"
version = "0.2.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "b4ac048d71ede7ee76d585517add45da530660ef4390e49b098733c6e897f254"

[[package]]
name = "utf8parse"
version = "0.2.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "06abde3611657adf66d383f00b093d7faecc7fa57071cce2578660c9f1010821"

[[package]]
name = "wait-timeout"
version = "0.2.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "09ac3b126d3914f9849036f826e054cbabdc8519970b8998ddaf3b5bd3c65f11"
dependencies = [
 "libc",
]

[[package]]
name = "walkdir"
version = "2.5.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "29790946404f91d9c5d06f9874efddea1dc06c5efe94541a7d6863108e3a5e4b"
dependencies = [
 "same-file",
 "winapi-util",
]

[[package]]
name = "wasi"
version = "0.11.1+wasi-snapshot-preview1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "ccf3ec651a847eb01de73ccad15eb7d99f80485de043efb2f370cd654f4ea44b"

[[package]]
name = "wasip2"
version = "1.0.1+wasi-0.2.4"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "0562428422c63773dad2c345a1882263bbf4d65cf3f42e90921f787ef5ad58e7"
dependencies = [
 "wit-bindgen",
]

[[package]]
name = "wasm-bindgen"
version = "0.2.106"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "0d759f433fa64a2d763d1340820e46e111a7a5ab75f993d1852d70b03dbb80fd"
dependencies = [
 "cfg-if",
 "once_cell",
 "rustversion",
 "wasm-bindgen-macro",
 "wasm-bindgen-shared",
]

[[package]]
name = "wasm-bindgen-macro"
version = "0.2.106"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "48cb0d2638f8baedbc542ed444afc0644a29166f1595371af4fecf8ce1e7eeb3"
dependencies = [
 "quote",
 "wasm-bindgen-macro-support",
]

[[package]]
name = "wasm-bindgen-macro-support"
version = "0.2.106"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "cefb59d5cd5f92d9dcf80e4683949f15ca4b511f4ac0a6e14d4e1ac60c6ecd40"
dependencies = [
 "bumpalo",
 "proc-macro2",
 "quote",
 "syn",
 "wasm-bindgen-shared",
]

[[package]]
name = "wasm-bindgen-shared"
version = "0.2.106"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "cbc538057e648b67f72a982e708d485b2efa771e1ac05fec311f9f63e5800db4"
dependencies = [
 "unicode-ident",
]

[[package]]
name = "web-time"
version = "1.1.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "5a6580f308b1fad9207618087a65c04e7a10bc77e02c8e84e9b00dd4b12fa0bb"
dependencies = [
 "js-sys",
 "wasm-bindgen",
]

[[package]]
name = "weezl"
version = "0.1.12"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "a28ac98ddc8b9274cb41bb4d9d4d5c425b6020c50c46f25559911905610b4a88"

[[package]]
name = "winapi-util"
version = "0.1.11"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "c2a7b1c03c876122aa43f3020e6c3c3ee5c05081c9a00739faf7503aeba10d22"
dependencies = [
 "windows-sys 0.61.2",
]

[[package]]
name = "windows-link"
version = "0.2.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "f0805222e57f7521d6a62e36fa9163bc891acd422f971defe97d64e70d0a4fe5"

[[package]]
name = "windows-sys"
version = "0.59.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "1e38bc4d79ed67fd075bcc251a1c39b32a1776bbe92e5bef1f0bf1f8c531853b"
dependencies = [
 "windows-targets 0.52.6",
]

[[package]]
name = "windows-sys"
version = "0.60.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "f2f500e4d28234f72040990ec9d39e3a6b950f9f22d3dba18416c35882612bcb"
dependencies = [
 "windows-targets 0.53.5",
]

[[package]]
name = "windows-sys"
version = "0.61.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "ae137229bcbd6cdf0f7b80a31df61766145077ddf49416a728b02cb3921ff3fc"
dependencies = [
 "windows-link",
]

[[package]]
name = "windows-targets"
version = "0.52.6"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "9b724f72796e036ab90c1021d4780d4d3d648aca59e491e6b98e725b84e99973"
dependencies = [
 "windows_aarch64_gnullvm 0.52.6",
 "windows_aarch64_msvc 0.52.6",
 "windows_i686_gnu 0.52.6",
 "windows_i686_gnullvm 0.52.6",
 "windows_i686_msvc 0.52.6",
 "windows_x86_64_gnu 0.52.6",
 "windows_x86_64_gnullvm 0.52.6",
 "windows_x86_64_msvc 0.52.6",
]

[[package]]
name = "windows-targets"
version = "0.53.5"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "4945f9f551b88e0d65f3db0bc25c33b8acea4d9e41163edf90dcd0b19f9069f3"
dependencies = [
 "windows-link",
 "windows_aarch64_gnullvm 0.53.1",
 "windows_aarch64_msvc 0.53.1",
 "windows_i686_gnu 0.53.1",
 "windows_i686_gnullvm 0.53.1",
 "windows_i686_msvc 0.53.1",
 "windows_x86_64_gnu 0.53.1",
 "windows_x86_64_gnullvm 0.53.1",
 "windows_x86_64_msvc 0.53.1",
]

[[package]]
name = "windows_aarch64_gnullvm"
version = "0.52.6"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "32a4622180e7a0ec044bb555404c800bc9fd9ec262ec147edd5989ccd0c02cd3"

[[package]]
name = "windows_aarch64_gnullvm"
version = "0.53.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "a9d8416fa8b42f5c947f8482c43e7d89e73a173cead56d044f6a56104a6d1b53"

[[package]]
name = "windows_aarch64_msvc"
version = "0.52.6"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "09ec2a7bb152e2252b53fa7803150007879548bc709c039df7627cabbd05d469"

[[package]]
name = "windows_aarch64_msvc"
version = "0.53.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "b9d782e804c2f632e395708e99a94275910eb9100b2114651e04744e9b125006"

[[package]]
name = "windows_i686_gnu"
version = "0.52.6"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "8e9b5ad5ab802e97eb8e295ac6720e509ee4c243f69d781394014ebfe8bbfa0b"

[[package]]
name = "windows_i686_gnu"
version = "0.53.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "960e6da069d81e09becb0ca57a65220ddff016ff2d6af6a223cf372a506593a3"

[[package]]
name = "windows_i686_gnullvm"
version = "0.52.6"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "0eee52d38c090b3caa76c563b86c3a4bd71ef1a819287c19d586d7334ae8ed66"

[[package]]
name = "windows_i686_gnullvm"
version = "0.53.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "fa7359d10048f68ab8b09fa71c3daccfb0e9b559aed648a8f95469c27057180c"

[[package]]
name = "windows_i686_msvc"
version = "0.52.6"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "240948bc05c5e7c6dabba28bf89d89ffce3e303022809e73deaefe4f6ec56c66"

[[package]]
name = "windows_i686_msvc"
version = "0.53.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "1e7ac75179f18232fe9c285163565a57ef8d3c89254a30685b57d83a38d326c2"

[[package]]
name = "windows_x86_64_gnu"
version = "0.52.6"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "147a5c80aabfbf0c7d901cb5895d1de30ef2907eb21fbbab29ca94c5b08b1a78"

[[package]]
name = "windows_x86_64_gnu"
version = "0.53.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "9c3842cdd74a865a8066ab39c8a7a473c0778a3f29370b5fd6b4b9aa7df4a499"

[[package]]
name = "windows_x86_64_gnullvm"
version = "0.52.6"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "24d5b23dc417412679681396f2b49f3de8c1473deb516bd34410872eff51ed0d"

[[package]]
name = "windows_x86_64_gnullvm"
version = "0.53.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "0ffa179e2d07eee8ad8f57493436566c7cc30ac536a3379fdf008f47f6bb7ae1"

[[package]]
name = "windows_x86_64_msvc"
version = "0.52.6"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "589f6da84c646204747d1270a2a5661ea66ed1cced2631d546fdfb155959f9ec"

[[package]]
name = "windows_x86_64_msvc"
version = "0.53.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "d6bbff5f0aada427a1e5a6da5f1f98158182f26556f345ac9e04d36d0ebed650"

[[package]]
name = "wit-bindgen"
version = "0.46.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "f17a85883d4e6d00e8a97c586de764dabcc06133f7f1d55dce5cdc070ad7fe59"

[[package]]
name = "x11rb"
version = "0.13.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "9993aa5be5a26815fe2c3eacfc1fde061fc1a1f094bf1ad2a18bf9c495dd7414"
dependencies = [
 "gethostname",
 "rustix",
 "x11rb-protocol",
]

[[package]]
name = "x11rb-protocol"
version = "0.13.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "ea6fc2961e4ef194dcbfe56bb845534d0dc8098940c7e5c012a258bfec6701bd"

[[package]]
name = "zerocopy"
version = "0.8.31"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "fd74ec98b9250adb3ca554bdde269adf631549f51d8a8f8f0a10b50f1cb298c3"
dependencies = [
 "zerocopy-derive",
]

[[package]]
name = "zerocopy-derive"
version = "0.8.31"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "d8a8d209fdf45cf5138cbb5a506f6b52522a25afccc534d1475dad8e31105c6a"
dependencies = [
 "proc-macro2",
 "quote",
 "syn",
]

[[package]]
name = "zune-core"
version = "0.4.12"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "3f423a2c17029964870cfaabb1f13dfab7d092a62a29a89264f4d36990ca414a"

[[package]]
name = "zune-jpeg"
version = "0.4.21"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "29ce2c8a9384ad323cf564b67da86e21d3cfdff87908bc1223ed5c99bc792713"
dependencies = [
 "zune-core",
]

</file>
<file path="Cargo.toml" mode="skeleton">
[package]
name = "rustymix"
version = "0.1.0"
edition = "2021"
description = "A high-performance Rust port of Repomix. Pack your repository into a single AI-friendly file."
license = "MIT"

[dependencies]
# Error handling
anyhow = "1.0.93"

# CLI &amp; UI
clap = { version = "4.5.21", features = ["derive", "env"] }
indicatif = "0.17.9"

# Filesystem &amp; Git
ignore = "0.4.23"
pathdiff = "0.2.3"
tempfile = "3.14.0"

# Serialization
serde = { version = "1.0.215", features = ["derive"] }
serde_json = "1.0.133"

# Text Processing
regex = "1.11.1"
tiktoken-rs = "0.5.9"
streaming-iterator = "0.1.9"
globset = "0.4.15"

# Concurrency
tokio = { version = "1.41.1", features = ["full"] }

# System
arboard = "3.4.1" # Clipboard support

# Tree Sitter (Code Compression)
# We pin these to ensure API compatibility
tree-sitter = "0.24.4"
tree-sitter-rust = "0.23.2"
tree-sitter-typescript = "0.23.2"
tree-sitter-javascript = "0.23.1"
tree-sitter-python = "0.23.4"
tree-sitter-go = "0.23.4"

[dev-dependencies]
assert_cmd = "2.0.16"
predicates = "3.1.2"
tempfile = "3.14.0"

[profile.release]
lto = true
strip = true
codegen-units = 1

</file>
<file path="src/main.rs" mode="skeleton">
mod cli;
// ... [implementation details hidden] ...
mod config;
// ... [implementation details hidden] ...
mod fs_tools;
// ... [implementation details hidden] ...
mod git;
// ... [implementation details hidden] ...
mod language;
// ... [implementation details hidden] ...
mod output;
// ... [implementation details hidden] ...
mod security;
// ... [implementation details hidden] ...
async fn main() -&gt; Result&lt;()&gt; {
    let cli = Cli::parse();

    // 1. Setup Config
    let mut config = RepomixConfig::default();
    
    let config_path = cli.config.clone().unwrap_or_else(|| "repomix.config.json".to_string());
    if Path::new(&amp;config_path).exists() {
        let content = fs::read_to_string(&amp;config_path)?;
        match serde_json::from_str::&lt;RepomixConfig&gt;(&amp;content) {
            Ok(file_config) =&gt; {
                if cli.verbose { println!("Loaded config from {}", config_path); }
                config = file_config;
            },
            Err(e) =&gt; {
                 if cli.verbose { eprintln!("Failed to parse config {}: {}", config_path, e); }
            }
        }
    } else if cli.verbose {
         println!("Config file {} not found", config_path);
    }

    // --- ARGUMENT PARSING &amp; OVERRIDES ---
    if let Some(s) = &amp;cli.output { config.output.file_path = s.clone(); }
    if cli.style != OutputStyle::Xml { config.output.style = cli.style; }
    if cli.copy { config.output.copy_to_clipboard = true; }
    if let Some(n) = cli.top_files_len { config.output.top_files_length = n; }
    if cli.output_show_line_numbers { config.output.show_line_numbers = true; }
    if cli.remove_comments { config.output.remove_comments = true; }
    if cli.remove_empty_lines { config.output.remove_empty_lines = true; }
    if cli.compress { config.output.compress = true; }
    if cli.include_empty_directories { config.output.include_empty_directories = true; }
    if cli.include_diffs { config.output.include_diffs = true; }
    if cli.include_logs { config.output.include_logs = true; }
    if let Some(h) = cli.header_text { config.output.header_text = Some(h); }
    if let Some(i) = cli.instruction_file_path { config.output.instruction_file_path = Some(i); }
    
    if let Some(sec) = cli.security_check {
        config.security.enable_security_check = sec;
    }
    
    if cli.no_gitignore { config.ignore.use_gitignore = false; }
    if cli.no_default_patterns { config.ignore.use_default_patterns = false; }
    
    if let Some(ign) = cli.ignore {
        config.ignore.custom_patterns.extend(ign.split(',').map(|s| s.to_string()));
    }

    // --- INTENT COLLECTION ---
    // We collect a list of (intent_name, intent_content) tuples.
    // If CLI intent is a directory, we populate this list.
    // If CLI intent is a file, we populate with one item.
    // If CLI intent is a string, we populate with one item.
    // If no intent, list is empty (default behavior).
    
    struct IntentTask {
        name: String,
        content: String,
    }

    let mut intent_tasks = Vec::new();
    let has_focus = cli.focus.is_some();
    let mut is_bulk_mode = false;

    if let Some(intent_arg) = &amp;cli.intent {
        let path = Path::new(intent_arg);
        if path.is_dir() {
            // Bulk mode
            is_bulk_mode = true;
            let entries = fs::read_dir(path)?;
            for entry in entries {
                let entry = entry?;
                let path = entry.path();
                if path.is_file() {
                    let name = path.file_stem().unwrap_or_default().to_string_lossy().to_string();
                    let content = fs::read_to_string(&amp;path)?;
                    intent_tasks.push(IntentTask { name, content });
                }
            }
        } else if path.is_file() {
            // File mode
            let name = path.file_stem().unwrap_or_default().to_string_lossy().to_string();
            let content = fs::read_to_string(path)?;
            intent_tasks.push(IntentTask { name, content });
        } else {
            // Raw string mode
            intent_tasks.push(IntentTask {
                name: "default".to_string(),
                content: intent_arg.clone()
            });
        }
    }

    // --- REPO ANALYSIS (Perform once) ---
    // 2. Handle Remote
    let temp_dir = tempfile::tempdir()?;
    let mut root_paths = Vec::new();

    if let Some(remote_url) = &amp;cli.remote {
        let target = temp_dir.path().join("repo");
        println!("Cloning remote repository...");
        git::clone_repo(remote_url, &amp;target, cli.remote_branch.as_deref())?;
        root_paths.push(target);
    } else {
        for d in &amp;cli.directories {
             if let Ok(canon) = fs::canonicalize(d) {
                root_paths.push(canon);
             } else {
                root_paths.push(PathBuf::from(d));
             }
        }
    }

    // Focus Logic
    let mut focus_set_builder = GlobSetBuilder::new();
    let has_focus_patterns = if let Some(focus_str) = &amp;cli.focus {
        for pattern in focus_str.split(',') {
            if let Ok(glob) = Glob::new(pattern.trim()) {
                focus_set_builder.add(glob);
            }
        }
        true
    } else {
        false
    };
    let focus_set = focus_set_builder.build()?;


    // 3. File Discovery
    let spinner = ProgressBar::new_spinner();
    spinner.set_style(ProgressStyle::default_spinner().template("{spinner} {msg}")?);
    spinner.set_message("Searching files...");
    spinner.enable_steady_tick(std::time::Duration::from_millis(100));

    let mut builder = WalkBuilder::new(&amp;root_paths[0]);
    for p in root_paths.iter().skip(1) {
        builder.add(p);
    }

    builder.git_ignore(config.ignore.use_gitignore);

    if config.ignore.use_default_patterns {
        builder.add_custom_ignore_filename(".repomixignore");
    }

    let mut overrides = ignore::overrides::OverrideBuilder::new(&amp;root_paths[0]);

    for pattern in &amp;config.ignore.custom_patterns {
        overrides.add(pattern)?;
    }

    if let Some(inc) = &amp;cli.include {
        for pattern in inc.split(',') {
             overrides.add(&amp;format!("!{}", pattern))?;
        }
    }
    
    builder.overrides(overrides.build()?);

    // Prepare manual globset for ignore patterns to ensure they work reliably
    let mut glob_builder = GlobSetBuilder::new();
    for pattern in &amp;config.ignore.custom_patterns {
        if let Ok(glob) = Glob::new(pattern) {
            glob_builder.add(glob);
        }
    }
    let custom_ignore_set = glob_builder.build()?;

    let walker = builder.build();
    let mut files_to_process = Vec::new();

    for result in walker {
        match result {
            Ok(entry) =&gt; {
                if entry.file_type().map(|ft| ft.is_file()).unwrap_or(false) {
                    let path = entry.into_path();

                    // Manual check against custom ignore patterns
                    // We check path relative to the root base
                    let rel_path = pathdiff::diff_paths(&amp;path, &amp;root_paths[0]).unwrap_or_else(|| path.clone());
                    if custom_ignore_set.is_match(&amp;rel_path) {
                        continue;
                    }

                    files_to_process.push(path);
                }
            }
            Err(err) =&gt; if cli.verbose { eprintln!("Error walking: {}", err) },
        }
    }

    spinner.set_message(format!("Found {} files. Processing...", files_to_process.len()));

    // 4. Processing
    let processed_files = Arc::new(Mutex::new(Vec::new()));
    let mut tasks = Vec::new();
    let root_base = root_paths[0].clone();

    for path in files_to_process {
        let config = config.clone();
        let processed_files = processed_files.clone();
        let root_base = root_base.clone();
        let focus_set = focus_set.clone();

        tasks.push(tokio::spawn(async move {
            if let Ok(content_bytes) = fs::read(&amp;path) {
                if fs_tools::is_binary(&amp;content_bytes) {
                    return;
                }

                let mut content = String::from_utf8_lossy(&amp;content_bytes).to_string();
                let ext = path.extension().and_then(|e| e.to_str()).unwrap_or("");

                if config.security.enable_security_check &amp;&amp; security::is_suspicious(&amp;content) {
                    return;
                }

                let rel_path = pathdiff::diff_paths(&amp;path, &amp;root_base)
                    .unwrap_or(path.clone())
                    .to_string_lossy()
                    .replace("\\", "/");

                // --- HYBRID COMPRESSION DECISION ---
                let is_focused = has_focus_patterns &amp;&amp; focus_set.is_match(&amp;rel_path);
                let should_compress_file = if has_focus_patterns {
                    !is_focused
                } else {
                    config.output.compress
                };

                if should_compress_file {
                    if let Some(compressed) = language::compression::compress_content(&amp;content, ext) {
                        content = compressed;
                    }
                }

                if config.output.remove_comments {
                    if let Some(stripped) = language::comments::remove_comments(&amp;content, ext) {
                        content = stripped;
                    }
                }

                if config.output.remove_empty_lines {
                    content = content.lines()
                        .filter(|l| !l.trim().is_empty())
                        .collect::&lt;Vec&lt;_&gt;&gt;()
                        .join("\n");
                }

                if config.output.show_line_numbers {
                    content = content.lines().enumerate()
                        .map(|(i, l)| format!("{:4}: {}", i + 1, l))
                        .collect::&lt;Vec&lt;_&gt;&gt;()
                        .join("\n");
                }

                let token_count = fs_tools::count_tokens(&amp;content);
                let char_count = content.chars().count();
                
                let mut pf = processed_files.lock().await;
                pf.push(ProcessedFile {
                    path: rel_path,
                    content,
                    char_count,
                    token_count,
                    is_skeleton: should_compress_file,
                });
            }
        }));
    }

    for task in tasks {
        let _ = task.await;
    }

    spinner.finish_with_message("Processing complete.");

    // 5. Sorting &amp; Git
    let mut files = Arc::try_unwrap(processed_files).unwrap().into_inner();
    
    if git::is_git_repo(&amp;root_paths[0]) {
        let counts = git::get_file_change_counts(&amp;root_paths[0]);
        files.sort_by(|a, b| {
            let count_a = counts.get(&amp;a.path).unwrap_or(&amp;0);
            let count_b = counts.get(&amp;b.path).unwrap_or(&amp;0);
            count_a.cmp(count_b) 
        });
    } else {
        files.sort_by(|a, b| a.path.cmp(&amp;b.path));
    }

    let git_diff = if config.output.include_diffs {
        git::get_diffs(&amp;root_paths[0]).ok()
    } else { None };

    let git_log = if config.output.include_logs {
        git::get_logs(&amp;root_paths[0]).ok()
    } else { None };

    
    // --- OUTPUT GENERATION LOOP ---
    
    // If no intents, we run once with default config
    if intent_tasks.is_empty() {
        intent_tasks.push(IntentTask { name: "default".to_string(), content: String::new() });
    }

    let total_tokens: usize = files.iter().map(|f| f.token_count).sum();
    let multi_output = intent_tasks.len() &gt; 1 || is_bulk_mode;

    for task in &amp;intent_tasks {
        let mut task_config = config.clone();

        // Construct header with intent
        let mut generated_header = String::new();
        if !task.content.is_empty() {
            if !has_focus {
                // PHASE 1: SURVEY
                generated_header.push_str("\n");
                generated_header.push_str("&lt;instruction&gt;\n");
                generated_header.push_str(&amp;format!("THE USER WANTS TO: {}\n\n", task.content));
                generated_header.push_str("Attached is the SKELETON of the codebase.\n");
                generated_header.push_str("Your job is to analyze this structure and identify which files are crucial to implement the request.\n");
                generated_header.push_str("You are a Context Engineer. Your goal is to construct the CLI command for the next phase (Phase 2) that carefully isolates the relevant code while excluding noise.\n\n");
                generated_header.push_str("## Tool Reference: rustymix\n");
                generated_header.push_str("rustymix packs a codebase into a single context file.\n");
                generated_header.push_str("- `--focus \"pattern1,pattern2\"`: Critical files/directories to read in FULL TEXT. Supports globs (e.g., `src/core/**`).\n");
                generated_header.push_str("- `--ignore \"pattern1,pattern2\"`: Files/directories to completely EXCLUDE from the pack (e.g., `tests/**`, `legacy_crate/**`).\n\n");
                generated_header.push_str("## Strategy\n");
                generated_header.push_str("- Use globs (`**`) to select entire relevant directories.\n");
                generated_header.push_str("- Exclude unrelated crates or directories to save tokens.\n");
                generated_header.push_str("- Focus on interfaces and definitions first if the task is exploratory.\n\n");
                generated_header.push_str("## Task\n");
                generated_header.push_str("Based on the user's intent and the attached skeleton, return a SINGLE LINE containing the optimized `rustymix` command arguments.\n");
                generated_header.push_str("Example: `--focus \"src/auth/**,src/main.rs\" --ignore \"tests/**\"`\n");
                generated_header.push_str("DO NOT provide explanations. Just the arguments.\n");
                generated_header.push_str("&lt;/instruction&gt;\n");
            } else {
                 // PHASE 2: BUILD
                 generated_header.push_str("\n");
                 generated_header.push_str("&lt;instruction&gt;\n");
                 generated_header.push_str(&amp;format!("THE USER WANTS TO: {}\n\n", task.content));
                 generated_header.push_str("Attached is the CONTEXT PACK.\n");
                 generated_header.push_str("- Files marked 'mode=\"full\"' are the specific files you requested.\n");
                 generated_header.push_str("- Files marked 'mode=\"skeleton\"' are compressed context to prevent hallucinations.\n");
                 generated_header.push_str("Please implement the requested changes based on this context.\n");
                 generated_header.push_str("&lt;/instruction&gt;\n");
            }
        }

        if let Some(existing) = task_config.output.header_text {
             task_config.output.header_text = Some(format!("{}\n{}", existing, generated_header));
        } else if !generated_header.is_empty() {
             task_config.output.header_text = Some(generated_header);
        }

        let output_string = output::generate_output(&amp;files, &amp;task_config, git_diff.as_deref(), git_log.as_deref());

        // Determine output path
        let out_path = if multi_output {
             // If multiple intents, we likely want to output to a specific directory or format filenames
             // "repomix-output-intentName.xml"
             let base_dir = if let Some(out_arg) = &amp;cli.output {
                 if Path::new(out_arg).is_dir() {
                     PathBuf::from(out_arg)
                 } else {
                     // If output arg is a file but we have multiple outputs, we fallback to parent dir
                     PathBuf::from(out_arg).parent().map(|p| p.to_path_buf()).unwrap_or_else(|| PathBuf::from("."))
                 }
             } else {
                 PathBuf::from(".")
             };

             let ext = match task_config.output.style {
                 OutputStyle::Xml =&gt; "xml",
                 OutputStyle::Markdown =&gt; "md",
                 OutputStyle::Json =&gt; "json",
                 OutputStyle::Plain =&gt; "txt",
             };

             base_dir.join(format!("repomix-{}.{}", task.name, ext))
        } else {
             PathBuf::from(&amp;task_config.output.file_path)
        };

        // Write
        if task_config.output.copy_to_clipboard &amp;&amp; !multi_output {
             if let Ok(mut clipboard) = arboard::Clipboard::new() {
                 let _ = clipboard.set_text(&amp;output_string);
                 println!("Output copied to clipboard!");
             }
        }

        if cli.output.as_deref() == Some("-") &amp;&amp; !multi_output {
            print!("{}", output_string);
        } else {
            if let Some(parent) = out_path.parent() {
                fs::create_dir_all(parent)?;
            }
            fs::write(&amp;out_path, &amp;output_string)?;
            println!("Output written to {}", out_path.display());
        }
    }

    if multi_output {
         println!("Processed {} intents.", intent_tasks.len());
    }

    println!("Total Files: {}", files.len());
    println!("Total Tokens: {}", total_tokens);

    Ok(())
}
</file>
</files>
</repomix>